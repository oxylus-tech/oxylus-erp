var Te=Object.defineProperty;var Pe=(r,n,m)=>n in r?Te(r,n,{enumerable:!0,configurable:!0,writable:!0,value:m}):r[n]=m;var v=(r,n,m)=>Pe(r,typeof n!="symbol"?n+"":n,m);import{models as h,useModels as q,t as y,useModelList as Se,query as Q,rules as _e,createPinia as Be,init as Fe}from"@oxylus/ox";import{OxAutocomplete as ie,OxModelList as Re,OxModelEdit as ue,OxField as O,OxModelPanel as re,OxFormList as de,App as je}from"@oxylus/ox/components";import{defineComponent as b,useAttrs as M,createBlock as _,createElementBlock as w,openBlock as p,mergeProps as x,unref as e,withCtx as l,createTextVNode as V,toDisplayString as f,Fragment as E,createVNode as t,useSlots as K,useModel as L,ref as J,createSlots as j,normalizeProps as T,guardReactiveProps as P,renderList as C,renderSlot as S,inject as me,watch as fe,onMounted as Ne,createCommentVNode as F,createElementVNode as Z,mergeModels as Ve,computed as X}from"vue";import{V as G,a as ee,b as D,c as k,d as g,e as R,f as ze,g as ye,h as Y,i as ve,j as I,A as Ze,k as ce}from"./vuetify.js";class ae extends h.Model{static fields(){return{id:this.attr(null),name:this.string(""),code:this.string(""),numeric:this.string(""),decimals:this.number(2),is_iso:this.boolean(!1),valid_to:this.string(null)}}}v(ae,"entity","currencies"),v(ae,"meta",new h.Meta({app:"ox_locations",model:"currency",url:"ox/locations/currency/",title:"name"}));class B extends h.Model{constructor(){super(...arguments);v(this,"code")}static fields(){return{id:this.attr(null),name:this.string(""),code:this.string(""),code_3:this.string(""),phone:this.number(null),continent:this.number(1),currency_code:this.string(""),currency:this.string(""),iban_sample:this.string(""),iban_length:this.number(34),$currency:this.belongsTo(ae,"currency")}}get flag(){if(typeof this.code!="string"||this.code.length!==2)return"";const m=127462,s=this.code.toUpperCase().split("");return s.every(a=>a>="A"&&a<="Z")?String.fromCodePoint(...s.map(a=>m+a.charCodeAt(0)-65)):""}}v(B,"entity","countries"),v(B,"meta",new h.Meta({app:"ox_locations",model:"country",url:"ox/locations/country/",title:"name"})),v(B,"_continentItems"),v(B,"Continent",h.Enum("continent",{AFRICA:1,ANTARCTICA:2,ASIA:3,EUROPE:4,NORTH_AMERICA:5,OCEANIA:6,SOUTH_AMERICA:7}));class oe extends h.Model{static fields(){return{id:this.attr(null),name:this.string(""),description:this.string(""),color:this.string(""),group:this.number(null),organisation:this.string(""),is_subscription:this.boolean(!1),contacts:this.attr([]),contact_count:this.number(0),$organisation:this.belongsTo(H,"organisation"),$group:this.belongsTo(h.Group,"group")}}}v(oe,"entity","contactLists"),v(oe,"meta",new h.Meta({app:"ox_contacts",model:"contactlist",url:"ox/contacts/contactlist/",title:"name"}));class he extends h.Model{static fields(){return{id:this.attr(null),name:this.string(""),email:this.string(""),emails:this.attr([]),phones:this.attr([]),addresses:this.attr([])}}}class te extends he{constructor(){super(...arguments);v(this,"first_name");v(this,"last_name")}static fields(){return{...super.fields(),user:this.number(null),first_name:this.string(""),last_name:this.string(""),organisations:this.attr([]),contact_lists:this.attr([]),$organisations:this.hasManyBy(H,"organisations"),$contact_lists:this.hasManyBy(oe,"contact_lists")}}get full_name(){return`${this.last_name} ${this.first_name}`}}v(te,"entity","persons"),v(te,"meta",new h.Meta({app:"ox_contacts",model:"person",url:"ox/contacts/person/",title:"full_name"}));class le extends h.Model{static fields(){return{id:this.attr(null),name:this.string(""),country:this.string(""),abbreviation:this.string(""),language_code:this.string(""),code:this.string(""),$country:this.belongsTo(B,"country")}}}v(le,"entity","organisationTypes"),v(le,"meta",new h.Meta({app:"ox_contacts",model:"organisationtype",url:"ox/contacts/organisationtype/",title:"name"}));class H extends he{static fields(){return{...super.fields(),short_name:this.string(""),color:this.string(""),reference:this.string(""),group:this.number(null),vat:this.string(""),type:this.string(""),country:this.string(""),contact_list:this.string(""),$type:this.belongsTo(le,"type"),$country:this.belongsTo(B,"country")}}}v(H,"entity","organisations"),v(H,"meta",new h.Meta({app:"ox_contacts",model:"organisation",url:"ox/contacts/organisation/",title:"name"}));class se extends h.Model{static fields(){return{id:this.attr(null),name:this.string(""),email:this.string(""),person:this.attr(null),organisation:this.attr(null)}}}v(se,"entity","contacts"),v(se,"meta",new h.Meta({app:"ox_contacts",model:"contact",url:"ox/contacts/contact/",title:"name"}));class N extends h.Model{static fields(){return{id:this.attr(null),contact:this.attr(null),kind:this.attr(null)}}}v(N,"Kind",h.Enum("kind",{MAIN:0,PROFESSIONAL:1,HOME:2,LEGAL:3,OTHER:16}));class xe extends N{static fields(){return{...super.fields(),street:this.string(""),street_2:this.string(""),number:this.number(null),box:this.string(""),city:this.string(""),country:this.string(""),$country:this.belongsTo(B,"country")}}}v(xe,"meta",new h.Meta({app:"ox_contacts",model:"address"}));class $e extends N{static fields(){return{...super.fields(),email:this.string("")}}}v($e,"meta",new h.Meta({app:"ox_contacts",model:"email"}));class Oe extends N{static fields(){return{...super.fields(),number:this.string("")}}}v(Oe,"meta",new h.Meta({app:"ox_contacts",model:"phone"}));class Ue extends N{static fields(){return{...super.fields(),name:this.string(""),iban:this.string(""),bic:this.string(""),address:this.string("")}}}v(Ue,"meta",new h.Meta({app:"ox_contacts",model:"bankaccount"}));function W(r=[],n={}){return q([h.User,h.Group,B,te,H,le,...r],n)}function ke(){return q([h.Group,H,te,se,oe])}const Ke=new RegExp("ATU[0-9]{8}|BE[0-1][0-9]{9}|BG[0-9]{9,10}|HR[0-9]{11}|CY[0-9]{8}[A-Z]|CZ[0-9]{8,10}|DE[0-9]{9}|DK[0-9]{8}|EE[0-9]{9}|EL[0-9]{9}|ES[A-Z][0-9]{7}(?:[0-9]|[A-Z]) |FI[0-9]{8}|FR[0-9A-Z]{2}[0-9]{9}|GB([0-9]{9}([0-9]{3})?|[A-Z]{2}[0-9]{3})|HU[0-9]{8}|IE[0-9]{7}[A-Z]{1,2}  |IE[0-9][A-Z][0-9]{5}[A-Z]|IT[0-9]{11}|LT([0-9]{9}|[0-9]{12}) |LU[0-9]{8}|LV[0-9]{11}|MT[0-9]{8}|NL[0-9]{9}B[0-9]{2}|PL[0-9]{10}|PT[0-9]{9}|RO[0-9]{2,10}|SE[0-9]{12}|SI[0-9]{8}|SK[0-9]{10}");function qe(r){return Ke.test(r)||y("fields.vat.rule")}const we=b({__name:"OxContactListName",props:{item:Object},setup(r){const n=M(),m=r;return(s,i)=>m.item.group?(p(),_(G,x({key:0,"prepend-icon":"mdi-account-multiple",color:m.item.color||"info"},e(n)),{default:l(()=>[V(f(m.item.name),1)]),_:1},16,["color"])):m.item.organisation?(p(),_(G,x({key:1,"prepend-icon":"mdi-domain",color:m.item.color||"secondary"},e(n)),{default:l(()=>[V(f(m.item.name),1)]),_:1},16,["color"])):(p(),w(E,{key:2},[t(ee,{color:m.item.color},{default:l(()=>[...i[0]||(i[0]=[V("mdi-card-account-details-star",-1)])]),_:1},8,["color"]),V(" "+f(m.item.name),1)],64))}}),Me=b({__name:"OxContactName",props:{item:Object},setup(r){const n=M(),m=r;return(s,i)=>m.item.organisation?(p(),_(G,x({key:0,"prepend-icon":"mdi-domain",color:m.item.organisation.color||"secondary"},e(n)),{default:l(()=>[V(f(m.item.name),1)]),_:1},16,["color"])):(p(),_(G,x({key:1,"prepend-icon":"mdi-card-account-details",color:s.infos},e(n)),{default:l(()=>[V(f(m.item.name),1)]),_:1},16,["color"]))}}),Ae=b({__name:"OxContactInput",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r,{expose:n}){const m=K(),s=M(),i=L(r,"modelValue"),a=q([se]),u=J(null);return n({get selected(){var o;return(o=u.value)==null?void 0:o.selected}}),(o,d)=>(p(),_(e(ie),x({ref_key:"input",ref:u,repo:e(a).contacts,"item-value":"id","item-title":"name",lookup:"search",modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=c=>i.value=c)},e(s)),j({selection:l(({item:c})=>[t(Me,{item:c.raw},null,8,["item"])]),item:l(({props:c,item:$})=>[t(D,T(P(c)),{prepend:l(()=>{var U;return[t(ee,{color:(U=$.raw.organisation)==null?void 0:U.color},{default:l(()=>[V(f($.raw.person?"mdi-card-account-details":"mdi-domain"),1)]),_:2},1032,["color"])]}),_:2},1040)]),_:2},[C(e(m),(c,$)=>({name:$,fn:l(U=>[S(o.$slots,$,T(P(U)))])}))]),1040,["repo","modelValue"]))}}),De=b({__name:"OxContactModelList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=me("repos"),m=L(r,"modelValue"),s=M(),i=J(null),a=J([]),u=J();function o(){u.value.list.updateWith(i.value.selected,!0),a.value=[]}return(d,c)=>(p(),w(E,null,[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(Ae,{ref_key:"input",ref:i,modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=$=>a.value=$),multiple:"",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(g,{cols:"1"},{default:l(()=>[t(R,{icon:"mdi-plus",size:"small",class:"mb-3",title:e(y)("actions.add"),"aria-label":e(y)("actions.add"),onClick:c[1]||(c[1]=$=>o())},null,8,["title","aria-label"])]),_:1})]),_:1}),t(e(Re),x({ref_key:"modelList",ref:u,repo:e(n).contacts,class:"grid"},e(s),{modelValue:m.value,"onUpdate:modelValue":c[2]||(c[2]=$=>m.value=$),editable:""}),{item:l(({item:$})=>[t(ze,null,{default:l(()=>[t(Me,{item:$},null,8,["item"])]),_:2},1024)]),_:1},16,["repo","modelValue"])],64))}}),Ge=b({__name:"OxContactListEdit",setup(r){const n=ke();me("user");const m=M(),{list:s,items:i}=Se({query:Q(n.contacts)});return fe(()=>{var a;return(a=m.initial)==null?void 0:a.id},a=>{s.filters.contact_lists__uuid=a,a&&s.load()}),Ne(()=>{var u;const a=(u=m.initial)==null?void 0:u.id;s.filters.contact_lists__uuid=a,a&&s.load()}),(a,u)=>(p(),_(e(ue),x(e(m),{repo:e(n).contactLists}),{default:l(({editor:o,editable:d})=>[t(k,null,{default:l(()=>[t(g,{cols:"2"},{default:l(()=>[t(e(O),{editor:o,name:"color",type:"color",disabled:o.value.organisation},null,8,["editor","disabled"])]),_:2},1024),t(g,null,{default:l(()=>[o.value.group||o.value.organisation?(p(),_(we,{key:0,item:o.value,class:"mt-4"},null,8,["item"])):(p(),_(e(O),{key:1,editor:o,name:"name",required:""},null,8,["editor"]))]),_:2},1024)]),_:2},1024),t(e(O),{editor:o,name:"description",type:"textarea"},null,8,["editor"]),!o.value.group&&!o.value.organisation?(p(),_(e(O),{key:0,editor:o,name:"is_subscription",type:"checkbox"},null,8,["editor"])):F("",!0),e(m).initial.id?(p(),_(ye,{key:1,multiple:"",modelValue:["contacts"]},{default:l(()=>[t(Y,{title:e(y)("models.contact",2),value:"contacts"},{text:l(()=>[t(De,{modelValue:o.value.contacts,"onUpdate:modelValue":c=>o.value.contacts=c},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["title"])]),_:2},1024)):F("",!0)]),_:1},16,["repo"]))}}),He=b({__name:"OxContactListPanel",props:{repo:{},view:{},headers:{default:["name","contact_count"]},relations:{default:["$group","$organisation"]},showFilters:{type:Boolean},fetchRelations:{type:Boolean,default:!0},search:{},warning:{},index:{},value:{},state:{},help:{},name:{},title:{},icon:{}},setup(r){const n=K(),m=ke(),s=r;return(i,a)=>(p(),_(e(re),x(s,{repo:e(m).contactLists}),j({"item.name":l(({item:u})=>[t(we,{item:u},null,8,["item"])]),"item.contact_count":l(({item:u})=>[V(f(e(y)("fields.contact_count.value",u.contact_count,{count:u.contact_count}))+" ",1),u.is_subscription?(p(),_(G,{key:0},{default:l(()=>[V(f(e(y)("fields.is_subscription")),1)]),_:1})):F("",!0)]),"views.detail.edit.default":l(({value:u,saved:o})=>[t(Ge,{initial:u,saved:o},null,8,["initial","saved"])]),_:2},[C(e(n),(u,o)=>({name:o,fn:l(d=>[S(i.$slots,o,T(P(d)))])}))]),1040,["repo"]))}}),ge=b({__name:"OxKindInput",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=L(r,"modelValue");return(m,s)=>(p(),_(ve,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=i=>n.value=i),placeholder:e(y)("fields.kind"),items:e(N).Kind.items},null,8,["modelValue","placeholder","items"]))}}),We=b({__name:"OxEmailForm",props:{item:Object},setup(r){const n=r;return(m,s)=>(p(),_(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.email,"onUpdate:modelValue":s[0]||(s[0]=i=>n.item.email=i),label:e(y)("fields.email"),rules:[e(_e).email]},null,8,["modelValue","label","rules"])]),_:1}),t(g,{cols:"4"},{default:l(()=>[t(ge,{modelValue:n.item.kind,"onUpdate:modelValue":s[1]||(s[1]=i=>n.item.kind=i)},null,8,["modelValue"])]),_:1})]),_:1}))}}),Ye=b({__name:"OxEmailFormList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=L(r,"modelValue"),m=M();return(s,i)=>(p(),_(e(de),x({modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},e(m)),{item:l(({item:a})=>[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[V(f(a.email),1)]),_:2},1024),t(g,{cols:"4"},{default:l(()=>[V(f(e(N).Kind.toString(a.kind)),1)]),_:2},1024)]),_:2},1024)]),"item.actions":l(({item:a})=>[t(R,{size:"small",href:`mailto:${a.email}`,icon:"mdi-mail",color:"primary"},null,8,["href"])]),"item.form":l(({item:a,index:u})=>[t(D,null,{default:l(()=>[t(We,{item:a},null,8,["item"])]),_:2},1024)]),_:1},16,["modelValue"]))}}),Je=b({__name:"OxPhoneForm",props:{item:Object},setup(r){const n=r;return(m,s)=>(p(),_(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(e(Ze),{modelValue:n.item.number,"onUpdate:modelValue":s[0]||(s[0]=i=>n.item.number=i),label:e(y)("fields.phone")},null,8,["modelValue","label"])]),_:1}),t(g,{cols:"4"},{default:l(()=>[t(ge,{modelValue:n.item.kind,"onUpdate:modelValue":s[1]||(s[1]=i=>n.item.kind=i)},null,8,["modelValue"])]),_:1})]),_:1}))}}),Qe=b({__name:"OxPhoneFormList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=L(r,"modelValue"),m=M();return(s,i)=>(p(),_(e(de),x({modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},e(m)),{item:l(({item:a})=>[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[V(f(a.number),1)]),_:2},1024),t(g,{cols:"4"},{default:l(()=>[V(f(e(N).Kind.toString(a.kind)),1)]),_:2},1024)]),_:2},1024)]),"item.form":l(({item:a,index:u})=>[t(D,null,{default:l(()=>[t(Je,{variant:"underlined",item:a},null,8,["item"])]),_:2},1024)]),"item.actions":l(({item:a})=>[t(R,{size:"small",href:`tel:${a.number}`,icon:"mdi-phone",color:"primary"},null,8,["href"])]),_:1},16,["modelValue"]))}});function Xe(){return q([B,ae],{useDefaults:!1})}function et(){const{countries:r}=q([B],{useDefaults:!1});return{countries:r}}const tt={class:"mr-2"},lt={class:"mr-2"},ne=b({__name:"OxCountryInput",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=K(),m=M(),s=L(r,"modelValue"),i=et();return(a,u)=>(p(),_(e(ie),x({repo:e(i).countries,lookup:"name__icontains","item-value":"id","item-title":"name",modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=o=>s.value=o)},e(m)),j({selection:l(({item:o})=>[Z("span",tt,f(o.raw.flag),1),V(" "+f(o.raw.name),1)]),item:l(({props:o,item:d})=>[t(D,T(P(o)),{prepend:l(()=>[Z("span",lt,f(d.raw.flag),1)]),_:2},1040)]),_:2},[C(e(n),(o,d)=>({name:d,fn:l(c=>[S(a.$slots,d,T(P(c)))])}))]),1040,["repo","modelValue"]))}}),nt={key:0,class:"v-messages"},at={key:0},ot={key:1,class:"text-warning"},st=b({__name:"OxIbanInput",props:Ve({label:String},{modelValue:{type:String,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const{countries:n,currencies:m}=Xe();Q(n).allOnce(),Q(m).allOnce();const s=r,i=L(r,"modelValue"),a=J(""),u=X(()=>i.value.length>=2?i.value.substring(0,2).toUpperCase():""),o=X(()=>u.value&&n.where("code",u.value).with("$currency").first()||null);fe(a,(U,A)=>{if(U!=A){const z=d(U);i.value!=z&&(i.value=z)}}),fe(i,(U,A)=>{if(U!=A){const z=c(U);a.value!=z&&(a.value=z)}});function d(U){return U.replace(/\s+/g,"").toUpperCase()}function c(U){var A;return((A=U.replace(/\s+/g,"").replace(/[^A-Z0-9]/gi,"").toUpperCase().match(/.{1,4}/g))==null?void 0:A.join(" "))||""}function $(U){var be;const A=U.replace(/\s+/g,"").toUpperCase();if((be=o.value)==null||be.iban_length,A.length<15)return y("fields.iban.too_short");const Le=(A.slice(4)+A.slice(0,4)).split("").map(pe=>isNaN(pe)?pe.charCodeAt(0)-55:pe).join("");return BigInt(Le)%97n===1n||y("fields.iban.invalid_checksum")}return(U,A)=>(p(),w(E,null,[t(I,{modelValue:a.value,"onUpdate:modelValue":A[0]||(A[0]=z=>a.value=z),label:s.label||"IBAN",rules:[$]},j({_:2},[o.value?{name:"prepend-inner",fn:l(()=>[V(f(o.value.flag),1)]),key:"0"}:void 0,o.value&&o.value.$currency?{name:"append",fn:l(()=>[V(f(o.value.$currency.code),1)]),key:"1"}:void 0]),1032,["modelValue","label","rules"]),o.value?(p(),w("p",nt,[o.value.iban_sample?(p(),w("div",at,[t(ee,{icon:"mdi-help-circle-outline"}),V(" "+f(e(y)("fields.iban.help",{name:o.value.name,sample:o.value.iban_sample||"..."})),1)])):(p(),w("div",ot,[t(ee,{icon:"mdi-alert-circle-outline"}),V(" "+f(e(y)("fields.iban.country_without_iban",{name:o.value.name})),1)]))])):F("",!0)],64))}}),it=b({__name:"OxAddressForm",props:{item:Object},setup(r){const n=r;return(m,s)=>(p(),_(ce,null,{default:l(()=>[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(ge,{modelValue:n.item.kind,"onUpdate:modelValue":s[0]||(s[0]=i=>n.item.kind=i)},null,8,["modelValue"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.street,"onUpdate:modelValue":s[1]||(s[1]=i=>n.item.street=i),label:e(y)("fields.street")},null,8,["modelValue","label"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.street_2,"onUpdate:modelValue":s[2]||(s[2]=i=>n.item.street_2=i),label:e(y)("fields.street_2")},null,8,["modelValue","label"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.number,"onUpdate:modelValue":s[3]||(s[3]=i=>n.item.number=i),label:e(y)("fields.number")},null,8,["modelValue","label"])]),_:1}),t(g,null,{default:l(()=>[t(I,{modelValue:n.item.box,"onUpdate:modelValue":s[4]||(s[4]=i=>n.item.box=i),label:e(y)("fields.box")},null,8,["modelValue","label"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.postcode,"onUpdate:modelValue":s[5]||(s[5]=i=>n.item.postcode=i),type:"number",label:e(y)("fields.postcode")},null,8,["modelValue","label"])]),_:1}),t(g,null,{default:l(()=>[t(I,{modelValue:n.item.city,"onUpdate:modelValue":s[6]||(s[6]=i=>n.item.city=i),label:e(y)("fields.city")},null,8,["modelValue","label"])]),_:1}),t(g,null,{default:l(()=>[t(e(ne),{modelValue:n.item.country,"onUpdate:modelValue":s[7]||(s[7]=i=>n.item.country=i),label:e(y)("fields.country")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}))}}),ut=b({__name:"OxAddressFormList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=L(r,"modelValue"),m=M();return(s,i)=>(p(),_(e(de),x({modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},e(m)),{item:l(({item:a})=>[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[V(f(a.street)+", "+f(a.number),1),i[1]||(i[1]=Z("br",null,null,-1)),V(" "+f(a.postcode)+", "+f(a.city)+" â€” "+f(a.country),1)]),_:2},1024),t(g,{cols:"4"},{default:l(()=>[V(f(e(N).Kind.toString(a.kind)),1)]),_:2},1024)]),_:2},1024)]),"item.form":l(({item:a,index:u})=>[t(D,null,{default:l(()=>[t(it,{item:a},null,8,["item"])]),_:2},1024)]),_:1},16,["modelValue"]))}}),rt=b({__name:"OxBankAccountForm",props:{item:Object},setup(r){const n=r;return(m,s)=>(p(),_(ce,null,{default:l(()=>[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.name,"onUpdate:modelValue":s[0]||(s[0]=i=>n.item.name=i),label:e(y)("fields.name")},null,8,["modelValue","label"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(e(st),{modelValue:n.item.iban,"onUpdate:modelValue":s[1]||(s[1]=i=>n.item.iban=i),label:e(y)("fields.iban")},null,8,["modelValue","label"])]),_:1}),t(g,{cols:"2"},{default:l(()=>[t(I,{modelValue:n.item.bic,"onUpdate:modelValue":s[2]||(s[2]=i=>n.item.bic=i),label:e(y)("fields.bic")},null,8,["modelValue","label"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.address,"onUpdate:modelValue":s[3]||(s[3]=i=>n.item.address=i),label:e(y)("fields.address")},null,8,["modelValue","label"])]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(I,{modelValue:n.item.bank_name,"onUpdate:modelValue":s[4]||(s[4]=i=>n.item.bank_name=i),label:e(y)("fields.bank_name")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}))}}),dt=b({__name:"OxBankAccountFormList",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=L(r,"modelValue"),m=M();return(s,i)=>(p(),_(e(de),x({modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},e(m)),{item:l(({item:a})=>[V(f(a.iban),1)]),"item.form":l(({item:a,index:u})=>[t(D,null,{default:l(()=>[t(rt,{item:a},null,8,["item"])]),_:2},1024)]),_:1},16,["modelValue"]))}}),Ce=b({__name:"OxContactInfos",props:Ve({editable:Boolean},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const n=L(r,"modelValue"),m=me("user"),s=r;return(i,a)=>(p(),w(E,null,[e(m).can("ox_contacts.view_email")?(p(),_(Y,{key:0,title:e(y)("fields.email",2),value:"emails"},{text:l(()=>[t(Ye,{modelValue:n.value.emails,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value.emails=u),"use-model":e($e),editable:s.editable},null,8,["modelValue","use-model","editable"])]),_:1},8,["title"])):F("",!0),e(m).can("ox_contacts.view_phone")?(p(),_(Y,{key:1,title:e(y)("fields.phone",2),value:"phones"},{text:l(()=>[t(Qe,{modelValue:n.value.phones,"onUpdate:modelValue":a[1]||(a[1]=u=>n.value.phones=u),"use-model":e(Oe),editable:s.editable},null,8,["modelValue","use-model","editable"])]),_:1},8,["title"])):F("",!0),e(m).can("ox_contacts.view_address")?(p(),_(Y,{key:2,title:e(y)("fields.address",2)},{text:l(()=>[t(ut,{modelValue:n.value.addresses,"onUpdate:modelValue":a[2]||(a[2]=u=>n.value.addresses=u),"use-model":e(xe),editable:s.editable},null,8,["modelValue","use-model","editable"])]),_:1},8,["title"])):F("",!0),e(m).can("ox_contacts.view_bankaccount")?(p(),_(Y,{key:3,title:e(y)("models.bankaccount",2)},{text:l(()=>[t(dt,{modelValue:n.value.addresses,"onUpdate:modelValue":a[3]||(a[3]=u=>n.value.addresses=u),"use-model":e(Ue),editable:s.editable},null,8,["modelValue","use-model","editable"])]),_:1},8,["title"])):F("",!0)],64))}}),Ee=b({__name:"OxPersonEdit",setup(r){const n=W(),m=M(),s=X(()=>n.organisations.all());return(i,a)=>(p(),_(e(ue),x(e(m),{repo:e(n).persons}),{default:l(({editor:u,editable:o,disabled:d})=>[t(ce,null,{default:l(()=>[t(e(O),{editor:u,name:"first_name"},null,8,["editor"]),t(e(O),{editor:u,name:"last_name"},null,8,["editor"]),t(e(O),{editor:u,name:"email",type:"email",rules:[e(_e).email],disabled:d||u.value.user},null,8,["editor","rules","disabled"]),t(e(O),{type:"select",multiple:"",editor:u,name:"organisations",items:s.value,"item-title":"name","item-value":"id"},null,8,["editor","items"])]),_:2},1024),t(ye,{multiple:"","model-value":["emails","phones"]},{default:l(()=>[t(Ce,{modelValue:u.value,"onUpdate:modelValue":c=>u.value=c,editable:o},null,8,["modelValue","onUpdate:modelValue","editable"])]),_:2},1024)]),_:1},16,["repo"]))}}),mt=b({__name:"OxPersonPanel",props:{repo:{},view:{},headers:{default:["first_name","last_name","email","phone","organisations"]},relations:{default:["$organisations"]},showFilters:{type:Boolean},fetchRelations:{type:Boolean},search:{},warning:{},index:{},value:{},state:{},help:{},name:{default:"persons"},title:{},icon:{}},setup(r){me("context");const n=K(),m=Object.keys(n).filter(u=>!["list.filters","item.groups"].includes(u)),s=W();Q(s.organisations).all();const i=X(()=>s.organisations.all()),a=r;return(u,o)=>(p(),_(e(re),x(a,{repo:e(s).persons}),j({"list.filters":l(({list:d,filters:c})=>[t(ve,{class:"ml-3",density:"compact",modelValue:c.organisations__uuid__in,"onUpdate:modelValue":$=>c.organisations__uuid__in=$,label:e(y)("models.organisations"),items:i.value,"item-title":"$title","item-value":"id","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label","items"]),S(u.$slots,"list.filters",{list:d,filters:c})]),"views.detail.edit.default":l(({value:d,saved:c})=>[t(Ee,{initial:d,saved:c},null,8,["initial","saved"])]),_:2},[C(e(m),d=>({name:d,fn:l(c=>[S(u.$slots,d,T(P(c)))])})),e(n)["item.organisations"]?void 0:{name:"item.organisations",fn:l(({item:d})=>[(p(!0),w(E,null,C(d.$organisations,c=>(p(),_(G,{size:"small",color:c.color??"primary",variant:"tonal",class:"mr-2"},{default:l(()=>[V(f(c.name),1)]),_:2},1032,["color"]))),256))]),key:"0"},e(n)["item.emails"]?void 0:{name:"item.email",fn:l(({item:d})=>[d.email?(p(),w(E,{key:0},[t(R,{href:`mailto:${d.email}`,size:"x-small","prepend-icon":"mdi-mail",color:"secondary"},{default:l(()=>[V(f(d.email),1)]),_:2},1032,["href"]),o[0]||(o[0]=Z("br",null,null,-1))],64)):F("",!0),(p(!0),w(E,null,C(d.emails,c=>(p(),w(E,null,[t(R,{href:`mailto:${c.email}`,size:"x-small","prepend-icon":"mdi-mail",color:"secondary"},{default:l(()=>[V(f(c.email),1)]),_:2},1032,["href"]),o[1]||(o[1]=Z("br",null,null,-1))],64))),256))]),key:"1"},e(n)["item.phones"]?void 0:{name:"item.phone",fn:l(({item:d})=>[(p(!0),w(E,null,C(d.phones,c=>(p(),w(E,null,[t(R,{href:`tel:${c.number}`,size:"x-small","prepend-icon":"mdi-phone",color:"secondary"},{default:l(()=>[V(f(c.number),1)]),_:2},1032,["href"]),o[2]||(o[2]=Z("br",null,null,-1))],64))),256))]),key:"2"}]),1040,["repo"]))}}),ct=b({__name:"OxPersonInput",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(r){const n=K(),m=M(),s=L(r,"modelValue"),i=q([te]);return(a,u)=>(p(),_(e(ie),x({repo:e(i).persons,"item-value":"id","item-title":"full_name",lookup:"search",modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=o=>s.value=o)},e(m)),j({_:2},[C(e(n),(o,d)=>({name:d,fn:l(c=>[S(a.$slots,d,T(P(c)))])}))]),1040,["repo","modelValue"]))}}),pt={class:"ml-2"},ft={class:"ml-2"},_t=b({__name:"OxOrganisationTypeInput",props:Ve({country:String},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const n=K(),m=r,s=M(),i=L(r,"modelValue"),a=q([le]);function u(o,d,c){return d=d.toUpperCase(),c.raw.name||console.log(c.raw),c.raw.name.toUpperCase().indexOf(d)!=-1||c.raw.abbreviation.toUpperCase().indexOf(d)!=-1}return(o,d)=>(p(),_(e(ie),x({repo:e(a).organisationTypes,"item-value":"id","item-title":"name",lookup:"search",filters:{country__uuid:m.country},"custom-filter":u,modelValue:i.value,"onUpdate:modelValue":d[0]||(d[0]=c=>i.value=c)},e(s)),j({selection:l(({item:c,index:$})=>[V(f(c.raw.name)+" ",1),Z("span",pt,f(c.raw.abbreviation),1)]),item:l(({props:c,item:$})=>[t(D,T(P(c)),{append:l(()=>[Z("span",ft,f($.raw.abbreviation),1)]),_:2},1040)]),_:2},[C(e(n),(c,$)=>({name:$,fn:l(U=>[S(o.$slots,$,T(P(U)))])}))]),1040,["repo","filters","modelValue"]))}}),Ie=b({__name:"OxOrganisationEdit",setup(r){const n=W(),m=M();function s(i){const a=i.value.type&&n.organisationtypes.find(i.value.type);a&&a.country!=i.value.country&&(i.value.type=null)}return(i,a)=>(p(),_(e(ue),x({ref:"model-editor"},e(m),{repo:e(n).organisations}),{default:l(({editor:u,editable:o})=>[t(ce,null,{default:l(()=>[t(k,null,{default:l(()=>[t(g,{cols:"2"},{default:l(()=>[t(e(O),{editor:u,name:"color",type:"color"},null,8,["editor"])]),_:2},1024),t(g,null,{default:l(()=>[t(e(O),{editor:u,name:"name",required:""},null,8,["editor"]),t(e(O),{editor:u,name:"short_name"},null,8,["editor"])]),_:2},1024)]),_:2},1024),t(e(O),{editor:u,name:"email",type:"email"},null,8,["editor"]),t(e(O),{editor:u,name:"reference"},null,8,["editor"]),t(e(O),{editor:u,name:"country"},{default:l(({props:d})=>[t(e(ne),x(d,{modelValue:u.value.country,"onUpdate:modelValue":[c=>u.value.country=c,c=>s(u)]}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1032,["editor"]),t(e(O),{editor:u,name:"vat",disabled:!o||!u.value.country,rules:[e(_e).optional(e(qe))]},null,8,["editor","disabled","rules"]),t(e(O),{editor:u,name:"type"},{default:l(({props:d})=>[t(_t,x(d,{modelValue:u.value.type,"onUpdate:modelValue":c=>u.value.type=c,country:u.value.country,disabled:!u.value.country}),null,16,["modelValue","onUpdate:modelValue","country","disabled"])]),_:2},1032,["editor"])]),_:2},1024),t(ye,{multiple:"","model-value":["emails","phones"]},{default:l(()=>[t(Ce,{modelValue:u.value,"onUpdate:modelValue":d=>u.value=d,editable:o},null,8,["modelValue","onUpdate:modelValue","editable"])]),_:2},1024)]),_:1},16,["repo"]))}}),Vt=b({__name:"OxOrganisationPanel",props:{repo:{},view:{},headers:{default:["name","email","vat","phone","country"]},relations:{default:["$country"]},showFilters:{type:Boolean},fetchRelations:{type:Boolean,default:!0},search:{},warning:{},index:{},value:{},state:{},help:{},name:{default:"organisations"},title:{},icon:{}},setup(r){const n=K(),m=Object.keys(n).filter(a=>!["list.filters","item.groups"].includes(a)),s=W();Q(s.organisations).all({dataKey:"results"}),X(()=>s.organisations.all());const i=r;return(a,u)=>(p(),_(e(re),x(i,{repo:e(s).organisations}),j({"list.filters":l(({list:o,filters:d})=>[t(e(ne),{modelValue:d.country__uuid__in,"onUpdate:modelValue":c=>d.country__uuid__in=c,class:"ml-2",label:e(y)("fields.country"),density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"]),S(a.$slots,"list.filters",{list:o,filters:d})]),"views.detail.edit.default":l(({value:o,saved:d})=>[t(Ie,{initial:o,saved:d},null,8,["initial","saved"])]),_:2},[C(e(m),o=>({name:o,fn:l(d=>[S(a.$slots,o,T(P(d)))])})),e(n)["item.country"]?void 0:{name:"item.country",fn:l(({item:o})=>{var d,c;return[V(f((d=o.$country)==null?void 0:d.flag)+" "+f((c=o.$country)==null?void 0:c.name),1)]}),key:"0"},e(n)["item.color"]?void 0:{name:"item.name",fn:l(({item:o})=>[t(ee,{color:o.color},{default:l(()=>[...u[0]||(u[0]=[V("mdi-domain",-1)])]),_:1},8,["color"]),V(" "+f(o.name),1)]),key:"1"},e(n)["item.email"]?void 0:{name:"item.email",fn:l(({item:o})=>[t(R,{href:`mailto:${o.email}`,size:"x-small","prepend-icon":"mdi-mail",color:"secondary"},{default:l(()=>[V(f(o.email),1)]),_:2},1032,["href"]),(p(!0),w(E,null,C(o.emails,d=>(p(),_(R,{href:`mailto:${d.email}`,size:"x-small","prepend-icon":"mdi-mail",color:"secondary"},{default:l(()=>[V(f(d.email),1)]),_:2},1032,["href"]))),256))]),key:"2"},e(n)["item.phone"]?void 0:{name:"item.phone",fn:l(({item:o})=>[(p(!0),w(E,null,C(o.phones,d=>(p(),_(R,{href:`tel:${d.number}`,size:"x-small","prepend-icon":"mdi-phone",color:"secondary"},{default:l(()=>[V(f(d.number),1)]),_:2},1032,["href"]))),256))]),key:"3"}]),1040,["repo"]))}}),yt=b({__name:"OxOrganisationTypeEdit",setup(r){const n=W(),m=M();return(s,i)=>(p(),_(e(ue),x({ref:"model-editor"},e(m),{repo:e(n).organisationTypes}),{default:l(({editor:a})=>[t(k,null,{default:l(()=>[t(g,null,{default:l(()=>[t(e(O),{editor:a,name:"name",required:""},null,8,["editor"])]),_:2},1024),t(g,{cols:"2"},{default:l(()=>[t(e(O),{editor:a,name:"abbreviation",required:""},null,8,["editor"])]),_:2},1024),t(g,{cols:"2"},{default:l(()=>[t(e(O),{editor:a,name:"code",required:""},null,8,["editor"])]),_:2},1024)]),_:2},1024),t(e(O),{editor:a,name:"country"},{default:l(({props:u})=>[t(e(ne),x(u,{modelValue:a.value.country,"onUpdate:modelValue":[o=>a.value.country=o,o=>s.countryUpdated(a)]}),null,16,["modelValue","onUpdate:modelValue"])]),_:2},1032,["editor"]),t(e(O),{editor:a,name:"language_code"},null,8,["editor"])]),_:1},16,["repo"]))}}),gt=b({__name:"OxOrganisationTypePanel",props:{repo:{},view:{},headers:{default:["name","abbreviation","code","country","language_code"]},relations:{default:["$country"]},showFilters:{type:Boolean},fetchRelations:{type:Boolean,default:!0},search:{},warning:{},index:{},value:{},state:{},help:{},name:{default:"organisationTypes"},title:{},icon:{}},setup(r){const n=K(),m=Object.keys(n).filter(a=>!["list.filters","top"].includes(a)),s=W(),i=r;return(a,u)=>(p(),_(e(re),x(i,{repo:e(s).organisationTypes,warning:e(y)("alerts.danger_zone_system_data")}),j({"list.filters":l(({list:o,filters:d})=>[t(e(ne),{modelValue:d.country__uuid__in,"onUpdate:modelValue":c=>d.country__uuid__in=c,class:"ml-2",label:e(y)("fields.country"),density:"compact","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"]),S(a.$slots,"list.filters",{list:o,filters:d})]),"views.detail.edit.default":l(({value:o,saved:d})=>[t(yt,{initial:o,saved:d},null,8,["initial","saved"])]),_:2},[C(e(m),o=>({name:o,fn:l(d=>[S(a.$slots,o,T(P(d)))])})),e(n)["item.currency"]?void 0:{name:"item.country",fn:l(({item:o})=>{var d,c;return[V(f((d=o.$country)==null?void 0:d.flag)+" "+f((c=o.$country)==null?void 0:c.name),1)]}),key:"0"}]),1040,["repo","warning"]))}}),bt=Object.freeze(Object.defineProperty({__proto__:null,OxContactInput:Ae,OxContactListPanel:He,OxOrganisationEdit:Ie,OxOrganisationPanel:Vt,OxOrganisationTypePanel:gt,OxPersonEdit:Ee,OxPersonInput:ct,OxPersonPanel:mt},Symbol.toStringTag,{value:"Module"})),vt={extends:je,components:bt},ht=Be();Fe({App:vt,plugins:[ht]});
//# sourceMappingURL=index.js.map
